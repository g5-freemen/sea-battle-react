{"version":3,"sources":["sound/hit.mp3","sound/miss.mp3","sound/fight.mp3","sound/winComp.mp3","sound/winPlayer.mp3","components/BattlefieldContext.jsx","components/Ship.jsx","components/ArrangeShips.jsx","components/DrawIdx.jsx","components/War.jsx","components/Battlefield.jsx","App.js","index.js"],"names":["BattlefieldContext","React","createContext","Provider","ContextApp","children","useState","arrangeShips","setArrangeShips","arrangeShipsMode","setArrangeShipsMode","Array","fill","map","playerBF","setPlayerBF","compBF","setCompBF","bfCoord","setBFcoord","playerShips","setPlayerShips","compShips","setCompShips","turn","setTurn","SHIPS_DATA","message","playerTurn","compTurn","begin","playerHits","playerMissed","compHits","compMissed","winPlayer","toUpperCase","winComp","useSound","mp3Hit","playHit","mp3Miss","playMiss","mp3Fight","playFight","mp3winComp","playWinComp","mp3winPlayer","playWinPlayer","getBFcoord","box","data","top","bottom","left","right","width","height","gridCol","el","idx","gridRow","useEffect","elem","document","querySelector","getBoundingClientRect","n","item","i","ship","num","length","prev","concat","createShips","querySelectorAll","value","getRnd","Math","ceil","random","checkWinner","includes","flat","filter","Ship","useContext","orientY","setOrientY","checkSetShip","shipCol","shipRow","trg","comp","putOk","e","newBF","a","coordY","coordX","undefined","onmousemove","onmouseup","setTimeout","toString","Fragment","className","id","uuid","style","onDragStart","onMouseDown","button","target","shiftX","pageX","shiftY","pageY","position","zIndex","moveAt","closest","x","y","onContextMenu","ev","preventDefault","ArrangeShips","addEventListener","key","onClick","DrawIdx","type","gridColumn","String","fromCharCode","War","alarm","setAlarm","shootCheck","bind","console","log","pads","body","cursor","evX","clientX","evY","clientY","Battlefield","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.8cb171c8.chunk.js","sourcesContent":["export default __webpack_public_path__ + \"static/media/hit.8c96d676.mp3\";","export default __webpack_public_path__ + \"static/media/miss.b9a5893c.mp3\";","export default __webpack_public_path__ + \"static/media/fight.15e2f926.mp3\";","export default __webpack_public_path__ + \"static/media/winComp.f369007a.mp3\";","export default __webpack_public_path__ + \"static/media/winPlayer.4834e938.mp3\";","import React, { useEffect, useState } from 'react';\r\nimport useSound from 'use-sound';\r\nimport mp3Hit from '../sound/hit.mp3';\r\nimport mp3Miss from '../sound/miss.mp3';\r\nimport mp3Fight from '../sound/fight.mp3';\r\nimport mp3winComp from '../sound/winComp.mp3';\r\nimport mp3winPlayer from '../sound/winPlayer.mp3';\r\nexport const BattlefieldContext = React.createContext({});\r\n\r\nconst Provider = BattlefieldContext.Provider;\r\n\r\nexport default function ContextApp ({ children }) {\r\n    const [ arrangeShips, setArrangeShips ] = useState(true);\r\n    const [ arrangeShipsMode, setArrangeShipsMode ] = useState('begin');\r\n    const [ playerBF, setPlayerBF ] = useState(Array(10).fill('-').map(() => Array(10).fill('-')));\r\n    const [ compBF, setCompBF ] = useState(Array(10).fill('-').map(() => Array(10).fill('-')));\r\n    const [ bfCoord, setBFcoord ] = useState({});\r\n    const [ playerShips, setPlayerShips ] = useState(null);\r\n    const [ compShips, setCompShips ] = useState(null);\r\n    const [ turn, setTurn ] = useState('begin'); //begin,player,comp\r\n    const SHIPS_DATA = [ [1, 4], [2, 3], [3, 2], [4, 1] ];\r\n\r\n    const message = {\r\n        playerTurn: 'Ваш ход!',\r\n        compTurn: 'Ход компьютера!',\r\n        begin: 'Да начнётся битва!',\r\n        playerHits: 'Вы попали!',\r\n        playerMissed: 'Вы промахнулись!',\r\n        compHits: 'Компьютер попал!',\r\n        compMissed: 'Компьютер промахнулся!',\r\n        winPlayer: 'Вы победили!'.toUpperCase(),\r\n        winComp: 'Компьютер победил!'.toUpperCase(),\r\n    };\r\n\r\n    const [playHit] = useSound(mp3Hit);\r\n    const [playMiss] = useSound(mp3Miss);\r\n    const [playFight] = useSound(mp3Fight);\r\n    const [playWinComp]= useSound(mp3winComp);\r\n    const [playWinPlayer]= useSound(mp3winPlayer);\r\n    \r\n    function checkWinner() {\r\n        if (turn.includes('comp') || turn.includes('player')) {\r\n            if ([...playerBF].flat().filter(el=> el===+el).length === 0) {\r\n                playWinComp();\r\n                setTurn('winComp');\r\n            }\r\n            if ([...compBF].flat().filter(el=> el===+el).length === 0) {\r\n                playWinPlayer();\r\n                setTurn('winPlayer');\r\n            }\r\n        }\r\n    }\r\n\r\n    function createShips(data) {\r\n        let n=0;\r\n        for (let item of data) \r\n            for (let i=0; i<item[0]; i++) {\r\n                let ship = { num: n++, length: item[1] }\r\n                setPlayerShips(prev => prev ? prev.concat(ship) : [ship]);\r\n                setCompShips(prev => prev ? prev.concat(ship) : [ship]);\r\n            }\r\n    };\r\n\r\n    function getRnd(i=0) {\r\n        while (i<1 || i>10) {\r\n          i = Math.ceil(Math.random()*10)\r\n        }\r\n        return i;\r\n    }\r\n\r\n    function getBFcoord(box) {\r\n        let data = {\r\n          top: box.top,\r\n          bottom: box.bottom,\r\n          left: box.left,\r\n          right: box.right,\r\n          width: box.width,\r\n          height: box.height,\r\n          gridCol: new Array(11).fill(0).map((el,idx) => box.left + idx * box.width/10),\r\n          gridRow: new Array(11).fill(0).map((el,idx) => box.top + idx * box.height/10)\r\n        };\r\n        setBFcoord(data);\r\n      }\r\n\r\n    useEffect(()=> {\r\n        let elem = document.querySelector('.battlefield-pad').getBoundingClientRect();\r\n        createShips(SHIPS_DATA);\r\n        getBFcoord(elem);\r\n        \r\n    }, [])\r\n\r\n    useEffect(()=> {\r\n        if (arrangeShips===false) {\r\n            let elem = document.querySelectorAll('.battlefield-pad')[1].getBoundingClientRect();\r\n            getBFcoord(elem);\r\n        }\r\n    }, [arrangeShips])\r\n\r\n    return (\r\n        <Provider value={{\r\n            arrangeShips, setArrangeShips,\r\n            arrangeShipsMode, setArrangeShipsMode,\r\n            playerBF, setPlayerBF,\r\n            compBF, setCompBF,\r\n            playerShips, setPlayerShips,\r\n            compShips, setCompShips,\r\n            bfCoord,\r\n            message,\r\n            turn, setTurn,\r\n            getRnd, playHit, playMiss, playFight, checkWinner\r\n        }}>\r\n            {children}\r\n        </Provider>\r\n    );\r\n};","import React, {useState, useContext, useEffect} from 'react';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\nimport uuid from 'react-uuid';\r\n\r\nexport default function Ship({length, num}) {\r\n  const { setPlayerShips, compShips, setCompShips,\r\n        compBF, setCompBF, bfCoord, playerBF,\r\n        setPlayerBF, arrangeShipsMode, getRnd } = useContext(BattlefieldContext);\r\n  const [ orientY, setOrientY ] = useState(arrangeShipsMode!=='auto' ? false : Math.random()>.5 );\r\n\r\n  function checkSetShip(shipCol,shipRow,trg,comp) {\r\n    let putOk = true;\r\n    for(let i=0; i<length; i++) {\r\n        try {\r\n          if (!comp) {\r\n            if (!orientY && playerBF[shipRow-1][shipCol-1+i] !== '-') putOk = false;\r\n            if (orientY && playerBF[shipRow-1+i][shipCol-1] !== '-') putOk = false;\r\n          } else {\r\n            if (!orientY && compBF[shipRow-1][shipCol-1+i] !== '-') putOk = false;\r\n            if (orientY && compBF[shipRow-1+i][shipCol-1] !== '-') putOk = false;\r\n          }\r\n        }\r\n        catch (e) {\r\n          putOk = false;\r\n        }\r\n    }\r\n\r\n    if (putOk) {\r\n      let newBF = comp ? [...compBF] : [...playerBF];\r\n\r\n      for(let i=0; i<length; i++) {  // set ship in array BF\r\n        if (!orientY)\r\n          newBF[shipRow-1][shipCol-1+i] = num\r\n        else\r\n          newBF[shipRow-1+i][shipCol-1] = num;\r\n      };\r\n\r\n      for (let a=0; a<3; a++) {\r\n        for(let i=0; i<length+2; i++) {  // set ship's deadarea in array BF\r\n          let coordY, coordX;\r\n            if (!orientY) { \r\n              coordY = shipRow-2+a;\r\n              coordX = shipCol-2+i;\r\n            } else {\r\n              coordY = shipRow-2+i;\r\n              coordX = shipCol-2+a;\r\n            }\r\n\r\n            if (coordY<0 || coordX<0 || coordY>9 || coordX>9) continue;\r\n              \r\n            let el = newBF[coordY][coordX];\r\n            if (el===undefined) continue;\r\n\r\n            if (el!==+el && el!=='D') newBF[coordY][coordX]='D';\r\n        }\r\n      }\r\n\r\n      if (!comp) {\r\n        setPlayerBF(newBF);\r\n        setPlayerShips(prev => prev.filter(el=> el.num!==num));\r\n      } else {\r\n        setCompBF(newBF);\r\n        setCompShips(prev => prev.filter(el=> el.num!==num));\r\n      }\r\n      document.onmousemove = null;\r\n      if (trg) trg.onmouseup = null;\r\n    }\r\n\r\n    if (!putOk) { // retry to set ship if bad position (auto set & comp bf) \r\n      if (!comp && arrangeShipsMode==='auto') {\r\n        checkSetShip(getRnd(),getRnd(),null)\r\n      } else if (comp) {\r\n        checkSetShip(getRnd(),getRnd(),null,true)\r\n      }\r\n    }\r\n  }\r\n\r\n  function handleShipMove(e) {\r\n      if (e.button !== 0) return;\r\n      let trg = e.target;\r\n      let box = trg.getBoundingClientRect();\r\n      let shiftX = e.pageX - box.left;\r\n      let shiftY = e.pageY - box.top;\r\n      \r\n      trg.style.position = 'absolute';\r\n      trg.style.zIndex = 9;\r\n\r\n      moveAt(e);\r\n    \r\n      function moveAt(e) {\r\n        trg.style.left = e.pageX - shiftX + 'px';\r\n        trg.style.top = e.pageY - shiftY + 'px';\r\n      }\r\n    \r\n      document.onmousemove = e => moveAt(e);\r\n\r\n      trg.onmouseup = function(e) {\r\n        let ship = e.target.closest('.ship').getBoundingClientRect();\r\n        let shipCol;\r\n        let shipRow;\r\n\r\n        for (let i=0; i<bfCoord.gridCol.length-1; i++) { // get ship's start position Col & Row\r\n          if (ship.x >= bfCoord.gridCol[i] && ship.x <= bfCoord.gridCol[i+1]) shipCol = i+1;\r\n          if (ship.y >= bfCoord.gridRow[i] && ship.y <= bfCoord.gridRow[i+1]) shipRow = i+1;\r\n        }\r\n\r\n        if (shipCol===undefined || shipRow===undefined || shipCol<1 || shipRow<1) return;\r\n        \r\n        if (arrangeShipsMode!=='auto') checkSetShip(shipCol,shipRow,trg);\r\n      };\r\n  }\r\n\r\n  function handleRotate(ev) {\r\n    ev.preventDefault();\r\n    setOrientY(prev=>!prev);\r\n  }\r\n           \r\n  useEffect( () => { // auto set ships for Player and PC \r\n    if (arrangeShipsMode==='auto') {\r\n      setTimeout(()=> {\r\n        let playerShipSet = playerBF.toString().includes(num);\r\n        if (!playerShipSet) checkSetShip(getRnd(),getRnd(),null);\r\n      },num*500);\r\n    };\r\n    let compShipSet = compBF.toString().includes(num);\r\n    if (!compShipSet) checkSetShip(getRnd(),getRnd(),null,true);\r\n  }, [playerBF,compBF] );\r\n\r\n  return (\r\n  <React.Fragment key = {uuid()}>\r\n    <span   className = 'ship'\r\n            id = {uuid()}\r\n            style = {!orientY ? {width: length*33, height: 33} : {width: 33, height: length*33}}\r\n            onDragStart = { () => {return false} }\r\n            onMouseDown = {handleShipMove}\r\n            onContextMenu = {handleRotate}\r\n    >\r\n      { num }\r\n    </span>\r\n    <span className='ship-margin' />\r\n  </React.Fragment>\r\n  )\r\n}","import React, {useEffect, useContext} from 'react';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\nimport uuid from 'react-uuid';\r\nimport Ship from './Ship';\r\n\r\nexport default function ArrangeShips() {\r\n    const { playerShips, arrangeShipsMode, setArrangeShipsMode, setArrangeShips } = useContext(BattlefieldContext);\r\n\r\n    function handleKeyboard(ev) {\r\n        if (ev.key==='1') setArrangeShipsMode('manual')\r\n        else if (ev.key==='2') setArrangeShipsMode('auto');\r\n    }\r\n\r\n    document.addEventListener('keydown',handleKeyboard);\r\n\r\n    useEffect( () => {\r\n        if (playerShips && playerShips.length===0)\r\n            setArrangeShipsMode('playerReady');\r\n    } , [playerShips]);\r\n\r\n    useEffect( () => {\r\n        if (arrangeShipsMode==='playerReady') setArrangeShips(false);\r\n    }, [arrangeShipsMode] )\r\n\r\n    return (\r\n        <div className='battlefield-menu'>\r\n\r\n            { (arrangeShipsMode==='begin' || arrangeShipsMode==='manual' || arrangeShipsMode==='auto') &&\r\n             <p className='battlefield-menu--title'>Расстановка кораблей\r\n                {arrangeShipsMode === 'manual' && <span>: вручную</span>}\r\n                {arrangeShipsMode === 'auto' && <span>: авто</span>}\r\n            </p> }\r\n\r\n            {arrangeShipsMode === 'manual' &&\r\n                <span className='battlefield-menu--remark'>\r\n                    Кликните на корабль левой кнопкой мыши чтобы выбрать его<br/>\r\n                    Кликните на корабль правой кнопкой мыши чтобы повернуть его\r\n                </span>}\r\n\r\n            { arrangeShipsMode === 'begin' &&\r\n            <ul className='battlefield-menu--list'>\r\n                <li onClick={()=>setArrangeShipsMode('manual')}> 1) Вручную </li>\r\n                <li onClick={()=>setArrangeShipsMode('auto')}> 2) Автоматически </li>\r\n            </ul>\r\n            }\r\n\r\n            { (arrangeShipsMode==='manual' || arrangeShipsMode==='auto') &&\r\n                <div className='battlefield-menu--ships'>\r\n                    { playerShips.map(ship =>\r\n                        <Ship key={uuid()} length={ship.length} num={ship.num} /> )\r\n                    }\r\n                </div>\r\n            }\r\n\r\n        </div>\r\n    )\r\n}","import uuid from 'react-uuid';\r\n\r\nexport default function DrawIdx({type}) {\r\n    const digits = [1,2,3,4,5,6,7,8,9,10];\r\n\r\n    return (\r\n    <div className={'battlefield-'+type}>\r\n    { digits.map( item =>\r\n        <span   className='idx'\r\n                key={uuid()}\r\n                style={ type==='digits' ? {gridColumn: item} : {gridRow: item} }>\r\n            { type === 'digits' ? item : item!==10 ? String.fromCharCode(item+1039) : 'К' }\r\n        </span>\r\n    ) }\r\n    </div>\r\n    )\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport uuid from 'react-uuid';\r\n\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\n\r\nexport default function War() {\r\n    const { message, bfCoord, compBF, setCompBF, playerBF, setPlayerBF,\r\n            getRnd, turn, setTurn, checkWinner,\r\n            playHit, playMiss, playFight } = useContext(BattlefieldContext);\r\n    const [ alarm, setAlarm ] = useState(null);\r\n\r\n    function shootCheck(x,y) {\r\n        if (!x || !y) {\r\n            x = getRnd();\r\n            y = getRnd();\r\n        }\r\n\r\n        let newBF = (turn==='player' ? [...compBF] : [...playerBF]);\r\n        let el = newBF[y-1][x-1];\r\n        if (+el===el) {             // hit the target\r\n            newBF[y-1][x-1] = 'X';\r\n            playHit();\r\n            turn==='player' ? setCompBF(newBF) : setPlayerBF(newBF);\r\n            turn==='player' ? setAlarm('playerHits') : setAlarm('compHits');\r\n\r\n            if (turn==='comp') {\r\n                setTimeout(() => {\r\n                    setTurn('comp '+uuid());\r\n                }, 999);\r\n            }\r\n            return;\r\n        } else if (el==='X' || el==='*') { // shoot second time the same point\r\n            turn.includes('comp') && setTurn('comp '+uuid());\r\n            return;  \r\n        } else {                    // miss the target\r\n            newBF[y-1][x-1] = '*';\r\n            playMiss();\r\n            turn==='player' ? setCompBF(newBF) : setPlayerBF(newBF);\r\n            turn==='player' ? setAlarm('playerMissed') : setAlarm('compMissed');\r\n            setTimeout(() => {\r\n                turn==='player' ? setTurn('comp') : setTurn('player');                \r\n            }, 999);\r\n            return; \r\n        }\r\n    }\r\n\r\n\r\n    useEffect( () => {\r\n        if (turn === 'begin') {\r\n            playFight();\r\n            setTimeout( setTurn.bind(null,'player'), 2000)\r\n        };\r\n\r\n        checkWinner();\r\n        console.log('turn=',turn)\r\n\r\n        const pads = document.querySelectorAll('.battlefield-pad');\r\n\r\n        if (turn.includes('player')) {\r\n            document.body.style.cursor = 'auto';\r\n            pads[1].style.cursor = 'pointer';\r\n            pads[1].addEventListener('click',(ev) => {\r\n                let x, y;\r\n                let evX = ev.clientX;\r\n                let evY = ev.clientY;\r\n        \r\n                for (let i=0; i<bfCoord.gridCol.length-1; i++) { // get player's shoot Col & Row\r\n                    if (evX >= bfCoord.gridCol[i] && evX <= bfCoord.gridCol[i+1]) x = i+1;\r\n                    if (evY >= bfCoord.gridRow[i] && evY <= bfCoord.gridRow[i+1]) y = i+1;\r\n                };\r\n\r\n                shootCheck(x,y);\r\n            } )\r\n        }\r\n\r\n        if (turn.includes('comp')) {\r\n            document.body.style.cursor = 'wait';\r\n            pads[1].style.cursor = 'wait';\r\n\r\n            shootCheck()\r\n        }\r\n    }, [turn]);\r\n\r\n    useEffect(()=> {\r\n        if (alarm) {\r\n            setTimeout(setAlarm.bind(null,null), 2000);\r\n        }\r\n    }, [alarm])\r\n\r\n    return (\r\n        <div className='war-info'>\r\n            { turn === 'begin' && message.begin }\r\n            { turn.includes('player') && message.playerTurn }\r\n            { turn.includes('comp') && message.compTurn }\r\n            { turn === 'winComp' && message.winComp }\r\n            { turn === 'winPlayer' && message.winPlayer }\r\n            &nbsp;\r\n            { alarm === 'playerHits' && message.playerHits }\r\n            { alarm === 'playerMissed' && message.playerMissed }\r\n            { alarm === 'compHits' && message.compHits }\r\n            { alarm === 'compMissed' && message.compMissed }\r\n        </div>\r\n    )\r\n}","import React, {useContext} from 'react';\r\nimport uuid from 'react-uuid';\r\n\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\n\r\nimport ArrangeShips from './ArrangeShips';\r\nimport DrawIdx from './DrawIdx';\r\nimport War from './War';\r\n\r\nexport default function Battlefield() {\r\n    const { arrangeShips, playerBF, compBF } = useContext(BattlefieldContext);\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <div className='container'>\r\n            <div className='battlefield'>\r\n                <DrawIdx type='digits'/>\r\n                <DrawIdx type='letters'/>\r\n                <div className='battlefield-pad'>\r\n                    { playerBF.length === 10 &&\r\n                    playerBF.flat().map(el=>\r\n                        <span \r\n                            className={+el===el ? 'shipEl' : el==='D' ? 'deadarea' : el==='X' ? 'hit' : 'empty'}\r\n                            key={uuid()}\r\n                        >\r\n                            { el==='*' && el }\r\n                        </span>) }\r\n                </div>\r\n            </div>\r\n\r\n            { arrangeShips && <ArrangeShips/> }\r\n\r\n            { !arrangeShips &&\r\n                <div className='battlefield battlefield--comp'>\r\n                    <DrawIdx type='digits'/>\r\n                    <DrawIdx type='letters'/>\r\n                    <div className='battlefield-pad'>\r\n                    { compBF.length === 10 &&\r\n                        compBF.flat().map(el=>\r\n                            <span   \r\n                                className={el==='X' ? 'hit' : 'empty'}\r\n                                key={uuid()} >\r\n                                    { el==='*' && el }\r\n                            </span>) }\r\n                    </div>\r\n                </div>\r\n            }\r\n        </div>\r\n\r\n        { !arrangeShips && <War/>}\r\n        </React.Fragment>\r\n    )\r\n}","import './App.css';\nimport ContextApp from './components/BattlefieldContext';\nimport Battlefield from './components/Battlefield';\n\nexport default function App() {\n  return (\n    <ContextApp>\n      <div className=\"App\">\n        <h1 className='app-title'>\n          Морской бой\n        </h1>\n        <Battlefield />\n      </div>\n    </ContextApp>\n  );\n}","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);"],"sourceRoot":""}