{"version":3,"sources":["components/message.js","sound/hit.mp3","sound/miss.mp3","sound/fight.mp3","sound/winComp.mp3","sound/winPlayer.mp3","components/BattlefieldContext.jsx","components/Ship.jsx","components/ArrangeShips.jsx","components/DrawIdx.jsx","components/War.jsx","components/Battlefield.jsx","App.js","index.js"],"names":["message","ru","gameTitle","arrangeShips","arrangeShipsManual","arrangeShipsAuto","remarkLBtn","remarkRBtn","playerTurn","compTurn","begin","playerHits","playerMissed","compHits","compMissed","winPlayer","winComp","en","BattlefieldContext","React","createContext","Provider","ContextApp","children","useState","setArrangeShips","arrangeShipsMode","setArrangeShipsMode","Array","fill","map","playerBF","setPlayerBF","compBF","setCompBF","bfCoord","setBFcoord","playerShips","setPlayerShips","compShips","setCompShips","turn","setTurn","turnNum","setTurnNum","window","navigator","language","includes","lang","setLang","timeMachine","setTimeMachine","useEffect","turnInfo","JSON","stringify","store","dispatch","type","payload","console","log","innerWidth","useSound","mp3Hit","playHit","mp3Miss","playMiss","mp3Fight","playFight","mp3winComp","playWinComp","mp3winPlayer","playWinPlayer","getBFcoord","box","data","top","bottom","left","right","width","height","gridCol","el","idx","gridRow","elem","document","querySelector","getBoundingClientRect","n","item","i","ship","num","length","prev","concat","createShips","querySelectorAll","value","getRnd","Math","ceil","random","checkWinner","flat","filter","Ship","useContext","orientY","setOrientY","checkSetShip","shipCol","shipRow","trg","comp","putOk","e","newBF","a","coordY","coordX","undefined","onmousemove","onmouseup","setTimeout","toString","Fragment","className","id","uuid","style","onDragStart","onMouseDown","button","target","shiftX","pageX","shiftY","pageY","position","zIndex","moveAt","closest","x","y","onContextMenu","ev","preventDefault","ArrangeShips","addEventListener","key","onClick","DrawIdx","gridColumn","String","fromCharCode","War","alarm","setAlarm","compLastHit","setCompLastHit","pads","shoot","evX","clientX","evY","clientY","shootCheck","body","cursor","playerBFstate","stop","j","newState","removeEventListener","bind","getState","classList","toggle","storedBFs","parse","newBFs","newPlayerBF","newCompBF","toUpperCase","Battlefield","title","href","createStore","state","action","App","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.b7c89569.chunk.js","sourcesContent":["export const message = {\r\n    ru: {\r\n        gameTitle: 'Морской бой',\r\n        arrangeShips: 'Расстановка кораблей',\r\n        arrangeShipsManual: 'Вручную',\r\n        arrangeShipsAuto: 'Автоматически',\r\n        remarkLBtn: 'Кликните на корабль левой кнопкой мыши чтобы выбрать его',\r\n        remarkRBtn: 'Кликните на корабль правой кнопкой мыши чтобы повернуть его',\r\n        playerTurn: 'Ваш ход!',\r\n        compTurn: 'Ход компьютера!',\r\n        begin: 'Да начнётся битва!',\r\n        playerHits: 'Вы попали!',\r\n        playerMissed: 'Вы промахнулись!',\r\n        compHits: 'Компьютер попал!',\r\n        compMissed: 'Компьютер промахнулся!',\r\n        winPlayer: 'Вы победили!',\r\n        winComp: 'Компьютер победил!',\r\n    },\r\n    en: {\r\n        gameTitle: 'Sea Battle',\r\n        arrangeShips: 'Arrange Ships',\r\n        arrangeShipsManual: 'Manual',\r\n        arrangeShipsAuto: 'Automatic',\r\n        remarkLBtn: 'Click left mouse button on the ship to select it',\r\n        remarkRBtn: 'Click right mouse button on the ship to rotate it',\r\n        playerTurn: 'Your turn!',\r\n        compTurn: 'Computer turn!',\r\n        begin: `Fight!`,\r\n        playerHits: 'Hit the target!',\r\n        playerMissed: 'Miss the target!',\r\n        compHits: 'Computer Hit the target!',\r\n        compMissed: 'Computer Miss the target!',\r\n        winPlayer: 'You Win!',\r\n        winComp: 'Computer Win!',\r\n    }\r\n};","export default __webpack_public_path__ + \"static/media/hit.8c96d676.mp3\";","export default __webpack_public_path__ + \"static/media/miss.b9a5893c.mp3\";","export default __webpack_public_path__ + \"static/media/fight.15e2f926.mp3\";","export default __webpack_public_path__ + \"static/media/winComp.f369007a.mp3\";","export default __webpack_public_path__ + \"static/media/winPlayer.4834e938.mp3\";","import React, { useEffect, useState } from 'react';\r\n\r\nimport { store } from '../App';\r\nimport { message } from './message';\r\n\r\nimport useSound from 'use-sound';\r\nimport mp3Hit from '../sound/hit.mp3';\r\nimport mp3Miss from '../sound/miss.mp3';\r\nimport mp3Fight from '../sound/fight.mp3';\r\nimport mp3winComp from '../sound/winComp.mp3';\r\nimport mp3winPlayer from '../sound/winPlayer.mp3';\r\n\r\nexport const BattlefieldContext = React.createContext({});\r\n\r\nconst Provider = BattlefieldContext.Provider;\r\n\r\nexport default function ContextApp ({ children }) {\r\n    const [ arrangeShips, setArrangeShips ] = useState(true);\r\n    const [ arrangeShipsMode, setArrangeShipsMode ] = useState('begin');\r\n    const [ playerBF, setPlayerBF ] = useState(Array(10).fill('-').map(() => Array(10).fill('-')));\r\n    const [ compBF, setCompBF ] = useState(Array(10).fill('-').map(() => Array(10).fill('-')));\r\n    const [ bfCoord, setBFcoord ] = useState({});\r\n    const [ playerShips, setPlayerShips ] = useState(null);\r\n    const [ compShips, setCompShips ] = useState(null);\r\n    const [ turn, setTurn ] = useState('begin'); //begin,player,comp\r\n    const [ turnNum, setTurnNum ] = useState(0);\r\n    const [ lang, setLang ] = useState(window.navigator.language.includes('ru') ? 'ru' : 'en');\r\n    const [ timeMachine, setTimeMachine ] = useState(false);\r\n\r\n    useEffect(() => {\r\n        if (turnNum>0 && !timeMachine) {\r\n            // console.log ('before=',store.getState().map(el=>JSON.parse(el)))\r\n            let turnInfo = JSON.stringify({ playerBF, compBF });\r\n            store.dispatch({ type: 'ADD_TURN', payload: turnInfo });\r\n            // console.log ('after=',store.getState().map(el=>JSON.parse(el)))\r\n        }\r\n        console.log(window.innerWidth);\r\n    }, [turnNum])\r\n    \r\n    const [playHit] = useSound(mp3Hit);\r\n    const [playMiss] = useSound(mp3Miss);\r\n    const [playFight] = useSound(mp3Fight);\r\n    const [playWinComp]= useSound(mp3winComp);\r\n    const [playWinPlayer]= useSound(mp3winPlayer);\r\n    \r\n    function checkWinner() {\r\n        if (turn.includes('comp') || turn==='player') {\r\n            if ([...playerBF].flat().filter(el=> el===+el).length === 0) {\r\n                setTurn('winComp');\r\n                playWinComp();\r\n            };\r\n            if ([...compBF].flat().filter(el=> el===+el).length === 0) {\r\n                setTurn('winPlayer');\r\n                playWinPlayer();\r\n            }\r\n        }\r\n    }\r\n\r\n    function createShips() {\r\n        const data = [ [1, 4], [2, 3], [3, 2], [4, 1] ];\r\n        let n=0;\r\n        for (let item of data) \r\n            for (let i=0; i<item[0]; i++) {\r\n                let ship = { num: n++, length: item[1] }\r\n                setPlayerShips(prev => prev ? prev.concat(ship) : [ship]);\r\n                setCompShips(prev => prev ? prev.concat(ship) : [ship]);\r\n            }\r\n    };\r\n\r\n    function getRnd(i=0) {\r\n        while (i<1 || i>10) {\r\n          i = Math.ceil(Math.random()*10)\r\n        }\r\n        return i;\r\n    }\r\n\r\n    function getBFcoord(box) {\r\n        let data = {\r\n          top: box.top,\r\n          bottom: box.bottom,\r\n          left: box.left,\r\n          right: box.right,\r\n          width: box.width,\r\n          height: box.height,\r\n          gridCol: new Array(11).fill(0).map((el,idx) => box.left + idx * box.width/10),\r\n          gridRow: new Array(11).fill(0).map((el,idx) => box.top + idx * box.height/10)\r\n        };\r\n        setBFcoord(data);\r\n      }\r\n\r\n    useEffect(()=> {\r\n        let elem = document.querySelector('.battlefield-pad').getBoundingClientRect();\r\n        createShips();\r\n        getBFcoord(elem);\r\n    }, [])\r\n\r\n    useEffect(()=> {\r\n        if (!arrangeShips) {\r\n            let box = document.querySelectorAll('.battlefield-pad')[1].getBoundingClientRect();\r\n            getBFcoord(box);\r\n        }\r\n    }, [arrangeShips])\r\n\r\n    return (\r\n        <Provider value={{\r\n            arrangeShips, setArrangeShips,\r\n            arrangeShipsMode, setArrangeShipsMode,\r\n            playerBF, setPlayerBF,\r\n            compBF, setCompBF,\r\n            playerShips, setPlayerShips,\r\n            compShips, setCompShips,\r\n            bfCoord, message,\r\n            lang, setLang,\r\n            turn, setTurn,\r\n            turnNum, setTurnNum,\r\n            timeMachine, setTimeMachine,\r\n            getRnd, playHit, playMiss, playFight, checkWinner,\r\n            store\r\n        }}>\r\n            {children}\r\n        </Provider>\r\n    );\r\n};","import React, {useState, useContext, useEffect} from 'react';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\nimport uuid from 'react-uuid';\r\n\r\nexport default function Ship({length, num}) {\r\n  const { setPlayerShips, setCompShips,\r\n        compBF, setCompBF, bfCoord, playerBF,\r\n        setPlayerBF, arrangeShipsMode, getRnd } = useContext(BattlefieldContext);\r\n  const [ orientY, setOrientY ] = useState(arrangeShipsMode!=='auto' ? false : Math.random()>.5 );\r\n\r\n  function checkSetShip(shipCol,shipRow,trg,comp) {\r\n    let putOk = true;\r\n    for(let i=0; i<length; i++) {\r\n        try {\r\n          if (!comp) {\r\n            if (!orientY && playerBF[shipRow-1][shipCol-1+i] !== '-') putOk = false;\r\n            if (orientY && playerBF[shipRow-1+i][shipCol-1] !== '-') putOk = false;\r\n          } else {\r\n            if (!orientY && compBF[shipRow-1][shipCol-1+i] !== '-') putOk = false;\r\n            if (orientY && compBF[shipRow-1+i][shipCol-1] !== '-') putOk = false;\r\n          }\r\n        }\r\n        catch (e) {\r\n          putOk = false;\r\n        }\r\n    }\r\n\r\n    if (putOk) {\r\n      let newBF = comp ? [...compBF] : [...playerBF];\r\n\r\n      for(let i=0; i<length; i++) {  // set ship in array BF\r\n        if (!orientY)\r\n          newBF[shipRow-1][shipCol-1+i] = num\r\n        else\r\n          newBF[shipRow-1+i][shipCol-1] = num;\r\n      };\r\n\r\n      for (let a=0; a<3; a++) {\r\n        for(let i=0; i<length+2; i++) {  // set ship's deadarea in array BF\r\n          let coordY, coordX;\r\n            if (!orientY) { \r\n              coordY = shipRow-2+a;\r\n              coordX = shipCol-2+i;\r\n            } else {\r\n              coordY = shipRow-2+i;\r\n              coordX = shipCol-2+a;\r\n            }\r\n\r\n            if (coordY<0 || coordX<0 || coordY>9 || coordX>9) continue;\r\n              \r\n            let el = newBF[coordY][coordX];\r\n            if (el===undefined) continue;\r\n\r\n            if (el!==+el && el!=='D') newBF[coordY][coordX]='D';\r\n        }\r\n      }\r\n\r\n      if (!comp) {\r\n        setPlayerBF(newBF);\r\n        setPlayerShips(prev => prev.filter(el=> el.num!==num));\r\n      } else {\r\n        setCompBF(newBF);\r\n        setCompShips(prev => prev.filter(el=> el.num!==num));\r\n      }\r\n      document.onmousemove = null;\r\n      if (trg) trg.onmouseup = null;\r\n    }\r\n\r\n    if (!putOk) { // retry to set ship if bad position (auto set & comp bf) \r\n      if (!comp && arrangeShipsMode==='auto') {\r\n        checkSetShip(getRnd(),getRnd(),null)\r\n      } else if (comp) {\r\n        checkSetShip(getRnd(),getRnd(),null,true)\r\n      }\r\n    }\r\n  }\r\n\r\n  function handleShipMove(e) {\r\n      if (e.button !== 0) return;\r\n      let trg = e.target;\r\n      let box = trg.getBoundingClientRect();\r\n      let shiftX = e.pageX - box.left;\r\n      let shiftY = e.pageY - box.top;\r\n      \r\n      trg.style.position = 'absolute';\r\n      trg.style.zIndex = 9;\r\n\r\n      moveAt(e);\r\n    \r\n      function moveAt(e) {\r\n        trg.style.left = e.pageX - shiftX + 'px';\r\n        trg.style.top = e.pageY - shiftY + 'px';\r\n      }\r\n    \r\n      document.onmousemove = e => moveAt(e);\r\n\r\n      trg.onmouseup = function(e) {\r\n        let ship = e.target.closest('.ship').getBoundingClientRect();\r\n        let shipCol;\r\n        let shipRow;\r\n\r\n        for (let i=0; i<bfCoord.gridCol.length-1; i++) { // get ship's start position Col & Row\r\n          if (ship.x >= bfCoord.gridCol[i] && ship.x <= bfCoord.gridCol[i+1]) shipCol = i+1;\r\n          if (ship.y >= bfCoord.gridRow[i] && ship.y <= bfCoord.gridRow[i+1]) shipRow = i+1;\r\n        }\r\n\r\n        if (shipCol===undefined || shipRow===undefined || shipCol<1 || shipRow<1) return;\r\n        \r\n        if (arrangeShipsMode!=='auto') checkSetShip(shipCol,shipRow,trg);\r\n      };\r\n  }\r\n\r\n  function handleRotate(ev) {\r\n    ev.preventDefault();\r\n    setOrientY(prev=>!prev);\r\n  }\r\n  \r\n  useEffect( () => { // auto set ships for Player and PC \r\n    if (arrangeShipsMode==='auto') {\r\n      setTimeout(()=> {\r\n        let playerShipSet = playerBF.toString().includes(num);\r\n        if (!playerShipSet) checkSetShip(getRnd(),getRnd(),null);\r\n      },num*500);\r\n    };\r\n    let compShipSet = compBF.toString().includes(num);\r\n    if (!compShipSet) checkSetShip(getRnd(),getRnd(),null,true);\r\n  }, [playerBF,compBF] );\r\n\r\n  return (\r\n  <React.Fragment key = {uuid()}>\r\n    <span   className = 'ship'\r\n            id = {uuid()}\r\n            style = {!orientY ? {width: length*33, height: 33} : {width: 33, height: length*33}}\r\n            onDragStart = { () => {return false} }\r\n            onMouseDown = {handleShipMove}\r\n            onContextMenu = {handleRotate}\r\n    />\r\n    <span className='ship-margin' />\r\n  </React.Fragment>\r\n  )\r\n}","import React, {useEffect, useContext} from 'react';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\nimport uuid from 'react-uuid';\r\nimport Ship from './Ship';\r\n\r\nexport default function ArrangeShips() {\r\n    const { lang, message, playerShips, arrangeShipsMode, setArrangeShipsMode, setArrangeShips } = useContext(BattlefieldContext);\r\n\r\n    function handleKeyboard(ev) {\r\n        if (ev.key==='1') setArrangeShipsMode('manual')\r\n        else if (ev.key==='2') setArrangeShipsMode('auto');\r\n    }\r\n\r\n    document.addEventListener('keydown',handleKeyboard);\r\n\r\n    useEffect( () => {\r\n        if (playerShips && playerShips.length===0)\r\n            setArrangeShipsMode('playerReady');\r\n    } , [playerShips]);\r\n\r\n    useEffect( () => {\r\n        if (arrangeShipsMode==='playerReady') setArrangeShips(false);\r\n    }, [arrangeShipsMode] )\r\n\r\n    return (\r\n        <div className='battlefield-menu'>\r\n\r\n            { (arrangeShipsMode==='begin' || arrangeShipsMode==='manual' || arrangeShipsMode==='auto') &&\r\n             <p className='battlefield-menu--title'> {message[lang].arrangeShips}\r\n                { lang==='en' && arrangeShipsMode!=='begin' &&\r\n                    <span>: {arrangeShipsMode}</span> \r\n                }\r\n                { lang==='ru' && arrangeShipsMode==='manual' && <span>: вручную</span> }\r\n                { lang==='ru' && arrangeShipsMode==='auto' && <span>: авто</span> }\r\n            </p> }\r\n\r\n            {arrangeShipsMode === 'manual' &&\r\n                <span className='battlefield-menu--remark'>\r\n                    { message[lang].remarkLBtn } <br/>\r\n                    { message[lang].remarkRBtn }\r\n                </span>}\r\n\r\n            { arrangeShipsMode === 'begin' &&\r\n            <ul className='battlefield-menu--list'>\r\n                <li onClick={()=>setArrangeShipsMode('manual')}> 1) {message[lang].arrangeShipsManual}</li>\r\n                <li onClick={()=>setArrangeShipsMode('auto')}> 2) {message[lang].arrangeShipsAuto}</li>\r\n            </ul>\r\n            }\r\n\r\n            { (arrangeShipsMode==='manual' || arrangeShipsMode==='auto') &&\r\n                <div className='battlefield-menu--ships'>\r\n                    { playerShips.map(ship =>\r\n                        <Ship key={uuid()} length={ship.length} num={ship.num} /> )\r\n                    }\r\n                </div>\r\n            }\r\n\r\n        </div>\r\n    )\r\n}","import { useContext } from 'react';\r\nimport uuid from 'react-uuid';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\n\r\nexport default function DrawIdx({type}) {\r\n    const digits = [1,2,3,4,5,6,7,8,9,10];\r\n    const { lang } = useContext(BattlefieldContext);\r\n\r\n    return (\r\n    <div className={'battlefield-'+type}>\r\n    { digits.map( item =>\r\n        <span   className='idx'\r\n                key={uuid()}\r\n                style={ type==='digits' ? {gridColumn: item} : {gridRow: item} }>\r\n            { type === 'digits' ? item : lang==='ru' && (item!==10 ? String.fromCharCode(item+1039) : 'К') }\r\n            { (type !== 'digits' && lang === 'en') && String.fromCharCode(item+64)  }\r\n        </span>\r\n    ) }\r\n    </div>\r\n    )\r\n}","import React, {useContext, useEffect, useState} from 'react';\r\nimport uuid from 'react-uuid';\r\n\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\n\r\nexport default function War() {\r\n    const { message, bfCoord, checkWinner, lang,\r\n            compBF, setCompBF, playerBF, setPlayerBF,\r\n            getRnd, turn, setTurn, \r\n            turnNum, setTurnNum,\r\n            playHit, playMiss, playFight,\r\n            store, timeMachine, setTimeMachine } = useContext(BattlefieldContext);\r\n    const [ alarm, setAlarm ] = useState(null);\r\n    const [ compLastHit, setCompLastHit ] = useState(null);\r\n    const pads = document.querySelectorAll('.battlefield-pad');\r\n\r\n    function turnBack() {\r\n        document.querySelector('.App').classList.toggle('darken');\r\n        setTimeout(() => {\r\n            document.querySelector('.App').classList.toggle('darken');\r\n        }, 1000);\r\n        setTimeMachine(true);\r\n        store.dispatch({ type: 'TURN_BACK', payload: turnNum-1 });\r\n\r\n        let storedBFs = store.getState().map(el => JSON.parse(el));\r\n        let newBFs = storedBFs[storedBFs.length-1]\r\n        let newPlayerBF = [...newBFs.playerBF];\r\n        let newCompBF = [...newBFs.compBF];\r\n        setPlayerBF( newPlayerBF );\r\n        setCompBF( newCompBF );\r\n        setTurnNum(prev=>prev-1);\r\n        if (turn!=='player') setTurn('player');\r\n    }\r\n\r\n    function shoot(ev) {\r\n        let x, y;\r\n        let evX = ev.clientX;\r\n        let evY = ev.clientY;\r\n\r\n        for (let i=0; i<bfCoord.gridCol.length-1; i++) { // get player's shoot Col & Row\r\n            if (evX >= bfCoord.gridCol[i] && evX <= bfCoord.gridCol[i+1]) x = i+1;\r\n            if (evY >= bfCoord.gridRow[i] && evY <= bfCoord.gridRow[i+1]) y = i+1;\r\n        };\r\n\r\n        shootCheck(x,y);\r\n    } \r\n\r\n    function shootCheck(x,y) {\r\n        if ([...playerBF].flat().filter(el=> el===+el).length === 0 ||\r\n        [...compBF].flat().filter(el=> el===+el).length === 0) {\r\n            checkWinner();\r\n            document.body.style.cursor = 'auto';\r\n            pads[1].style.cursor = 'pointer';            \r\n            return;\r\n        }\r\n\r\n        if (!x || !y) {\r\n            x = getRnd();\r\n            y = getRnd();\r\n        }\r\n\r\n        if (turn.includes('comp') && compLastHit!==null ) {   // comp shoot second time the same ship\r\n            let playerBFstate = [...playerBF];\r\n            \r\n            if (playerBFstate.flat().toString().includes(compLastHit)) {\r\n                if ( Math.random()<.4 ) { // chance <40%\r\n                    let stop = false;\r\n                    for (let i=0; i<playerBFstate.length; i++) {\r\n                        for (let j=0; j<playerBFstate[i].length; j++) {\r\n                            if (playerBFstate[i][j]===compLastHit && !stop) {\r\n                                playHit();\r\n                                playerBFstate[i][j]='X';\r\n                                let newState = turn+(uuid());\r\n                                setTurn(newState);\r\n                                stop = true;\r\n                            }\r\n                        }\r\n                    }\r\n                setCompLastHit(null);\r\n                setPlayerBF(playerBFstate);\r\n                return;\r\n                } else setCompLastHit(null);\r\n            }\r\n        }\r\n\r\n        let newBF = (turn==='player' ? [...compBF] : [...playerBF]);\r\n        let el = newBF[y-1][x-1];\r\n        if (+el===el) {             // hit the target\r\n            turn.includes('comp') && setCompLastHit(el);\r\n            newBF[y-1][x-1] = 'X';\r\n            playHit();\r\n            turn==='player' ? setCompBF(newBF) : setPlayerBF(newBF);\r\n            turn==='player' ? setAlarm('playerHits') : setAlarm('compHits');\r\n\r\n            if (turn.includes('comp')) {\r\n                let newState = turn + uuid();\r\n                setTimeout( () => setTurn(newState), 999);\r\n            }\r\n        } else if (el==='X' || el==='*') {  // shoot second time the same point\r\n            if (turn.includes('comp')) {\r\n                let newState = turn+(uuid());\r\n                setTurn(newState);\r\n            }\r\n            return;\r\n        } else {    // miss the target\r\n                newBF[y-1][x-1] = '*';\r\n                playMiss();\r\n                turn==='player' ? setCompBF(newBF) : setPlayerBF(newBF);\r\n                turn==='player' ? setAlarm('playerMissed') : setAlarm('compMissed');\r\n            setTimeout(() => {\r\n                if (turn==='player') setTurn('comp')\r\n                else if (turn.includes('comp')) setTurn('player');\r\n            }, 999);\r\n        }\r\n    }\r\n\r\n    useEffect( () => {\r\n        if (!turn.includes('player')) {\r\n            try {\r\n                if (pads.length>1) pads[1].removeEventListener('click',shoot);\r\n            }\r\n            catch(e) {\r\n                console.log(e);\r\n            }\r\n        }\r\n\r\n        if (!turn.includes('win')) checkWinner();\r\n\r\n        if (turn === 'begin') {\r\n            playFight();\r\n            setTimeout( setTurn.bind(null,'player'), 2000);\r\n        };\r\n\r\n        if (turn.includes('player')) {\r\n            document.body.style.cursor = 'auto';\r\n            pads[1].style.cursor = 'pointer';\r\n            pads[1].addEventListener('click',shoot);\r\n        }\r\n\r\n        if (turn.includes('comp')) {\r\n            document.body.style.cursor = 'wait';\r\n            pads[1].style.cursor = 'wait';\r\n            shootCheck()\r\n        }\r\n    }, [turn]);\r\n\r\n    useEffect(()=> alarm && setTimeout(() => setAlarm(null), 2000), [alarm]);\r\n\r\n    useEffect(() => {\r\n        console.log('compBF=',compBF);\r\n        console.log('redux store=',store.getState());\r\n        !timeMachine && setTurnNum( store.getState().length+1 );\r\n        timeMachine && setTimeMachine(false);\r\n    }, [compBF] )\r\n\r\n    return (\r\n        <React.Fragment>\r\n        <div className='time-machine--box'>\r\n            {turnNum>1 && \r\n                <button className='time-machine--back'\r\n                        onClick={turnBack}>\r\n                    &#10094;\r\n                </button>\r\n            }\r\n            <div className='turn-counter'>\r\n                {turnNum}\r\n            </div>\r\n        </div>\r\n        <div className='war-info'>\r\n            { turn === 'begin' && message[lang].begin }\r\n            { turn === 'player' && message[lang].playerTurn }\r\n            { turn.includes('comp') && message[lang].compTurn }\r\n            { turn === 'winComp' && message[lang].winComp.toUpperCase() }\r\n            { turn === 'winPlayer' && message[lang].winPlayer.toUpperCase() }\r\n            &nbsp;\r\n            { alarm === 'playerHits' && message[lang].playerHits }\r\n            { alarm === 'playerMissed' && message[lang].playerMissed }\r\n            { alarm === 'compHits' && message[lang].compHits }\r\n            { alarm === 'compMissed' && message[lang].compMissed }\r\n        </div>\r\n        </React.Fragment>\r\n    )\r\n}","import React, {useContext} from 'react';\r\nimport uuid from 'react-uuid';\r\nimport { BattlefieldContext } from \"./BattlefieldContext\";\r\nimport ArrangeShips from './ArrangeShips';\r\nimport DrawIdx from './DrawIdx';\r\nimport War from './War';\r\n\r\nexport default function Battlefield() {\r\n    const { message, lang, setLang, arrangeShips, playerBF, compBF } = useContext(BattlefieldContext);\r\n\r\n    function handleLangBtn(ev) {\r\n        ev.target.classList.toggle('lang-en');\r\n        lang==='ru' ? setLang('en') : setLang('ru');\r\n        if (ev.target.className.includes('lang-en')) \r\n            document.title = message.en.gameTitle\r\n        else document.title = message.ru.gameTitle;\r\n    }\r\n\r\n    return (\r\n        <div className='wrap'>\r\n            <button className='btn-lang' onClick={handleLangBtn} />\r\n            <h1 className='app-title'>\r\n                { message[lang].gameTitle }\r\n            </h1>\r\n            <div className='container'>\r\n                <div className='battlefield'>\r\n                    <DrawIdx type='digits'/>\r\n                    <DrawIdx type='letters'/>\r\n                    <div className='battlefield-pad'>\r\n                        { playerBF.length === 10 &&\r\n                        playerBF.flat().map(el=>\r\n                            <span \r\n                                className={+el===el ? 'shipEl' : el==='D' ? 'deadarea' : el==='X' ? 'hit' : 'empty'}\r\n                                key={uuid()}\r\n                            >\r\n                                { el==='*' && el }\r\n                            </span>) }\r\n                    </div>\r\n                </div>\r\n\r\n                { arrangeShips && <ArrangeShips/> }\r\n\r\n                { !arrangeShips &&\r\n                    <div className='battlefield battlefield--comp'>\r\n                        <DrawIdx type='digits'/>\r\n                        <DrawIdx type='letters'/>\r\n                        <div className='battlefield-pad'>\r\n                        { compBF.length === 10 &&\r\n                            compBF.flat().map(el=>\r\n                                <span className={el==='X' ? 'hit' : 'empty'} key={uuid()} >\r\n                                    { el==='*' && el }\r\n                                </span>) }\r\n                        </div>\r\n                    </div>\r\n                }\r\n            </div>\r\n\r\n            { !arrangeShips && <War/>}\r\n\r\n            <footer className=\"footer\">\r\n                <a className=\"footer__link\" href=\"https://github.com/g5-freemen\">\r\n                        Made by Anton Borkovskij, 2021\r\n                </a>\r\n            </footer>\r\n        </div>\r\n    )\r\n}","import './App.css';\r\nimport ContextApp from './components/BattlefieldContext';\r\nimport Battlefield from './components/Battlefield';\r\nimport { createStore } from 'redux';\r\n\r\nfunction timeMachine(state = [], action) {\r\n  if (action.type === 'ADD_TURN') {\r\n    return [...state, action.payload];\r\n  } else if (action.type ===  'TURN_BACK') {\r\n    return [...state].filter((el,idx) => idx<action.payload );\r\n  } \r\n  return [...state];\r\n}\r\n\r\nexport const store = createStore(timeMachine);\r\n\r\nexport default function App() {\r\n  return (\r\n    <ContextApp>\r\n      <div className=\"App\">\r\n        <Battlefield />\r\n      </div>\r\n    </ContextApp>\r\n  );\r\n}","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);"],"sourceRoot":""}